## 随机数生成工具类
## 提供各种随机数生成和随机选择功能
extends Node
class_name 引擎随机

## 初始化随机数生成器（使用当前时间作为种子）
##[codeblock]
## 引擎.随机.打乱()  # 初始化随机种子
##[/codeblock]
func 打乱() -> void:
	randomize()

## 生成指定范围内的随机浮点数
## [br]参数:[br]
##   - 最小浮点数: 最小值（包含）[br]
##   - 最大浮点数: 最大值（包含）
## [br]返回:[br]
##   - 范围内的随机浮点数
##[codeblock]
## var 随机值 = 引擎.随机.取范围浮点数(1.5, 3.5)
##[/codeblock]
func 取范围浮点数(最小浮点数: float, 最大浮点数: float) -> float:
	return randf_range(最小浮点数, 最大浮点数)

## 生成0到1之间的随机浮点数（包含0和1）
## [br]返回:[br]
##   - 0到1之间的随机浮点数
##[codeblock]
## var 随机值 = 引擎.随机.取0到1的浮点数()
##[/codeblock]
func 取0到1的浮点数() -> float:
	return randf()

## 生成0到指定值之间的随机整数（包含0和指定值）
## [br]参数:[br]
##   - 最大整数: 最大值（包含）
## [br]返回:[br]
##   - 0到最大整数之间的随机整数
##[codeblock]
## var 随机数 = 引擎.随机.取整数(10)  # 生成0-10之间的随机整数
##[/codeblock]
func 取整数(最大整数: int) -> int:
	return randi_range(0, 最大整数)

## 生成指定范围内的随机整数（包含最小值和最大值）
## [br]参数:[br]
##   - 最小整数: 最小值（包含）[br]
##   - 最大整数: 最大值（包含）
## [br]返回:[br]
##   - 范围内的随机整数
##[codeblock]
## var 随机数 = 引擎.随机.取范围整数(5, 15)
##[/codeblock]
func 取范围整数(最小整数: int, 最大整数: int) -> int:
	return randi_range(最小整数, 最大整数)

## 生成0到360之间的随机整数角度（包含0和360）
## [br]返回:[br]
##   - 0到360之间的随机整数角度
##[codeblock]
## var 角度 = 引擎.随机.取角度整数()
##[/codeblock]
func 取角度整数() -> int:
	return randi_range(0, 360)

## 生成0到360之间的随机浮点角度（包含0和360）
## [br]返回:[br]
##   - 0到360之间的随机浮点角度
##[codeblock]
## var 角度 = 引擎.随机.取角度浮点数()
##[/codeblock]
func 取角度浮点数() -> float:
	return randf_range(0.0, 360.0)

## 从字符串数组中随机选择一个字符串
## [br]参数:[br]
##   - 字符串数组: 要选择的字符串数组
## [br]返回:[br]
##   - 随机选择的字符串，如果数组为空则返回空字符串
##[codeblock]
## var 颜色 = 引擎.随机.取字符串(["红", "绿", "蓝"])
##[/codeblock]
func 取字符串(字符串数组: Array) -> String:
	if 字符串数组.size() == 0:
		return ""
	else:
		return 字符串数组[取范围整数(0, 字符串数组.size() - 1)]

#[[1023, 20], [1045, 20], [1067, 20], [1164, 1]],从1-61取出权重对应值
func 从权重数组获取值(物品列表: Array) -> String:
	var 总权重 = 0
	for 物品 in 物品列表:
		总权重 += 物品[1]
	
	var 随机值 = 取范围整数(1,总权重)#randi() % 总权重 + 1
	var 累加权重 = 0
	for 物品 in 物品列表:
		累加权重 += 物品[1]
		if 随机值 <= 累加权重:
			return str(物品[0])
	
	return "-1"  # 如果没有找到合适的ID，返回-1（理论上不会发生）
